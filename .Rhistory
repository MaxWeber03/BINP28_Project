library(SNPRelate)
library(SNPRelate)
package_version(SNPRelate)
package_version("SNPRelate")
library(SNPRelate)
package_version("SNPRelate")
sessionInfo()
# Read .vcf and convert to GDS --------------------------------------------
?snpgdsVCF2GDS
snpgdsVCF2GDS(vcf.fn = "./02_vcf_filtered/an_ac_filtered.vcf",
out.fn = "./03_gdp/converted.gdc",
method = "copy.num.of.ref" # ncluding bi-allelic SNPs, multi-allelic SNPs, indels and structural variants
)
snpgdsSummary(gds = "./03_gdp/converted.gdc")
sessionInfo()
# LD Pruning --------------------------------------------------------------
spn_pruned = snpgdsLDpruning(genofile, ld.threshold=0.2)
# BiocManager::install("SNPRelate")
library(SNPRelate)
# LD Pruning --------------------------------------------------------------
spn_pruned = snpgdsLDpruning(genofile, ld.threshold=0.2)
# LD Pruning --------------------------------------------------------------
snp_data = snpgdsOpen("./03_gdp/converted.gdc")
snpgdsVCF2GDS(vcf.fn = "./02_vcf_filtered/an_ac_filtered.vcf",
out.fn = "./03_gdp/converted.gdc",
method = "copy.num.of.ref" # ncluding bi-allelic SNPs, multi-allelic SNPs, indels and structural variants
)
snpgdsVCF2GDS(vcf.fn = "./02_vcf_filtered/an_ac_filtered.vcf",
out.fn = "./03_gdp_pruning/converted.gds",
method = "copy.num.of.ref" # ncluding bi-allelic SNPs, multi-allelic SNPs, indels and structural variants
)
snpgdsVCF2GDS(vcf.fn = "./02_vcf_filtered/an_ac_filtered.vcf",
out.fn = "./03_gdsp_pruning/converted.gds",
method = "copy.num.of.ref" # ncluding bi-allelic SNPs, multi-allelic SNPs, indels and structural variants
)
snpgdsVCF2GDS(vcf.fn = "./02_vcf_filtered/an_ac_filtered.vcf",
out.fn = "./03_gds_pruning/converted.gds",
method = "copy.num.of.ref" # ncluding bi-allelic SNPs, multi-allelic SNPs, indels and structural variants
)
snpgdsSummary(gds = "./03_gds_pruning/converted.gds")
# LD Pruning --------------------------------------------------------------
snp_data = snpgdsOpen("./03_gdp/converted.gdc")
# LD Pruning --------------------------------------------------------------
snp_data = snpgdsOpen("./03_gds/converted.gdc")
# LD Pruning --------------------------------------------------------------
snp_data = snpgdsOpen("./03_gds/converted.gds")
# LD Pruning --------------------------------------------------------------
snp_data = snpgdsOpen("./03_gds_pruning/converted.gds")
# run pruning
spn_pruned = snpgdsLDpruning(snp_data, ld.threshold=0.2)
View(spn_pruned)
View(snp_data)
View(spn_pruned)
str(spn_pruned)
str(snp_data)
source("~/OneDrive/Uni/Master_Lund/2._Semester/BINP28_Sequencing_Informatics_I/11_Project/03_pruning_pca.R", echo = TRUE)
source("~/OneDrive/Uni/Master_Lund/2._Semester/BINP28_Sequencing_Informatics_I/11_Project/03_pruning_pca.R", echo = TRUE)
source("~/OneDrive/Uni/Master_Lund/2._Semester/BINP28_Sequencing_Informatics_I/11_Project/03_pruning_pca.R", echo = TRUE)
View(snp_correlation)
?snpgdsPCACorr
savepar <- par(mfrow=c(2,1), mai=c(0.45, 0.55, 0.1, 0.25))
# calculate the SNP correlations between eigenvactors and SNP geno --------
CORR <- snpgdsPCACorr(pca, snp_data,
eig.which=1:4) # uses eigenvector 1 to 4
savepar <- par(mfrow=c(2,1), mai=c(0.45, 0.55, 0.1, 0.25))
for (i in 1:2)
{
plot(abs(CORR$snpcorr[i,]), ylim=c(0,1), xlab="", ylab=paste("PC", i),
col=chr, pch="+")
}
for (i in 1:2){
plot(abs(CORR$snpcorr[i,]), ylim=c(0,1), xlab="", ylab=paste("PC", i), pch="+")
}
View(CORR)
